"use strict";!function(e){function s(e,s){var c="";return"msoffice"===s?c=function(e){switch(function(e){var s,c=e.indexOf("?");c>-1&&(e=e.substr(0,c));if(s=e.split("."),1===s.length)return"";return s.pop()}(e).toLowerCase()){case"docx":case"doc":case"docm":case"dot":case"dotm":case"dotx":case"odt":return"ms-word";case"xltx":case"xltm":case"xlt":case"xlsx":case"xlsm":case"xlsb":case"xls":case"xll":case"xlam":case"xla":case"ods":return"ms-excel";case"pptx":case"pptm":case"ppt":case"ppsx":case"ppsm":case"pps":case"ppam":case"ppa":case"potx":case"potm":case"pot":case"odp":return"ms-powerpoint";case"accdb":case"mdb":return"ms-access";case"xsn":case"xsf":return"ms-infopath";case"pub":return"ms-publisher";case"vstx":case"vstm":case"vst":case"vssx":case"vssm":case"vss":case"vsl":case"vsdx":case"vsdm":case"vsd":case"vdw":return"ms-visio";case"mpp":case"mpt":return"ms-project";default:return""}}(e)+":ofe|u|":"libreoffice"===s?c="vnd.libreoffice.command:":"openoffice"===s&&(c="vnd.sun.star.webdav:"),e=c+e.replace(/^.*:/,window.location.protocol)}e((function(){e(".jqWebDAVLink").livequery((function(){var c=e(this);(e.detectOS.Windows||e.detectOS.MacOS)&&c.on("click",(function(){var a=s(c.attr("href"),foswiki.getPreference("TopicInteractionPlugin").officeSuite);return e("<iframe />").hide().attr("src",a).appendTo("body"),!1}))}))}))}(jQuery);
